---
# tasks file for nfs-client-playbook
# Insert the needed variables
  
- name: Install NFS Utilities Software
  yum:
    name: nfs-utils
    state: present
        
- name: Create Mount Point for Client
  file:
    path: "{{nfspath}}"
    state: directory

- name: Mount NFS Share for NFS-SERVER
  mount:
    path: "{{nfspath}}"
    src: "{{nfsmount}}"
    fstype: nfs4
    opts: "{{nfsoptions}}"
    state: mounted

- name: start nfs
  become: yes
  service:
    name: nfs
    state: started
    enabled: yes

- name: Add port to firewalld
  firewalld:
    port: "{{ item }}"
    permanent: yes
    state: enabled
  when: ansible_distribution == 'CentOS' or ansible_distribution == 'Red Hat Enterprise Linux'
  loop:
   - 2048/tcp
   - 2049/tcp
   - 111/tcp

- become: yes
  firewalld:
    service: nfs
    permanent: yes
    state: enabled

- become: yes
  firewalld:
    service: mountd
    permanent: yes
    state: enabled 

- become: yes
  firewalld:
    service: rpc-bind
    permanent: yes
    state: enabled 

  
